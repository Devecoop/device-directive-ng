<!DOCTYPE html>
<html>
  <head>
    <title>device-ng | AngularJS directive to control your devices, on web and mobile</title>
    <link rel="stylesheet" href="public/style.css">
    <link rel="stylesheet" href="public/icons/css/slate.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Italiana&amp;subset=latin">
    <link rel="stylesheet" href="public/bower_components/animate.css/animate.css" />
    <link rel="stylesheet" href="public/bower_components/fontawesome/css/font-awesome.css" />
    <link rel="stylesheet" href="public/bower_components/device-directive-ng/dist/device-component-ng.css">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
  </head>
  <body>

    <section id="top">
    <div id="menu">
      <a id="toggle" href="#">
        <i class="icon-menu"></i>
      </a>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#howto">How To</a></li>
        <li><a href="#configurations">Configurations</a></li>
        <li><a href="#customizations">Customizations</a></li>
        <li><a href="#events">Events</a></li>
        <li><a href="#links">Links</a></li>
        <li><a href="#thanks">Thanks To</a></li>
      </ul>
    </div>

    <div id="heading">
      <div id="logo">&lt;device&gt;</div>
      <div id="tagline">The new HTML5 tag to control your devices, on web and mobile</a></div>
      <p><img src="public/images/device.png" style="width:auto"></img></p>
      <!--<div id="device">-->
        <!--<device-->
          <!--device-id="1"-->
          <!--device-template="public/bower_components/device-directive-ng/dist/views/templates/default.html">-->
        <!--</device>-->
      <!--<div>-->
    </div>
    </section>

    <section>
    <div class="content">
      <h1 id="introduction">Introduction</h1>
      <p>
      Device is an AngularJS directive that makes it easy to monitor and control your
      physical devices (e.g. lights, locks, thermostats) from desktop, tablet, and mobile.
      To make this possible it uses <a href="http://lelylan.com/" target="_blank">Lelylan</a>,
      a simple, open and robust REST API for the Connected Home.
      </p>
    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="getting-started">Getting Started</h1>

      <h2>Installation</h2>

      <p>
      Install the device directive using <a href="http://bower.io/" target="_blank">Bower</a>.
      </p>

      <pre><code>$ bower install device-directive-ng --save</code></pre>

      <h2>Basic Example</h2>

      <p>
      Use the &lt;device&gt; directive and set the desired device ID.
      </p>

      <pre><code><xmp><device device-id="DEVICE_ID"></device></xmp></code></pre>

      <p>
      To fully understand how it works read the <a href="#howto">next section</a>.
      </p>

    </div>
    </section>


    <section>
    <div class="content">


      <h1 id="howto">Create your first app using &lt;device&gt;</h1>
      <p>
      In this section you will learn how to use the device directive to monitor and control
      all the devices you have defined in Lelylan.
      </p>

      <p class="btn-group">
      <a href="" class="btn" target="_blank">View Demo</a>
      <a href="" class="btn" target="_blank">Download Source</a>
      </p>


      <h2 id="setup">Setup</h2>

      <p>
      To build our app we'll use <a href="http://yeoman.io" target="blank">Yeoman</a>, a collection of tools
      and frameworks helping developers to quickly build web applications.
      </p>

      <ul>
        <li>
        <strong>yo</strong> - perform ripetitive tasks.
        </li>
        <li>
        <strong>grunt</strong> - build, preview and test your project.
        </li>
        <li>
        <strong>bower</strong> - solve the frontend package management.
        </li>
      </ul>


      <h2>Installation</h2>

      <p>
      With a recent version of Node.js installed, install the <code>yo</code> package.
      In this way you have Yo, Grunt and Bower and can run them directly from the command-line.
      </p>

      <pre><code>$ npm install -g yo</code></pre>

      <p>
      With Yeoman you can install additional generators with npm. For this tutorial you need
      to install the AngularJS generator.
      </p>

      <pre><code>$ npm install -g generator-angular</code></pre>


      <h2>Create your AngularJS app</h2>

      <p>
      To begin, go to the terminal, make a new directory and cd into it.
      </p>

      <pre><code>$ mkdir new-project && cd $_</code></pre>

      <p>
      You can now kick-start your AngularJS app.
      </p>

      <pre><code>$ yo angular</code></pre>

      <p>
      It will also ask you if you would like to include Twitter Bootstrap and other stuff.
      Once you've decided, just hit Enter. It will take a while to complete.
      </p>

      <p>
      To preview what the app looks like run the serve command.
      </p>

      <pre><code>$ grunt serve</code></pre>

      <p>
      The server supports LiveReload, meaning you can fire up a text editor, edit a custom
      element and the browser will reload on save.
      </p>


      <h2>Install the device directive</h2>

      <p>
      Install the device directive using <a href="http://bower.io/">Bower</a>.
      </p>

      <pre><code>$ bower install device-directive-ng --save</code></pre>

      <p>
      Now you have <code>&lt;device&gt;</code> directive and all its dependencies ready to be
      used. Restart the server to automatically add the needed javascript files to your index
      page.
      </p>

      <pre><code>$ grunt serve</code></pre>

      <p>
      The setup is now completed.
      </p>


      <h2>Add the device directive</h2>

      <p>
      Inject the device directive into your AngularJS application.
      </p>

      <pre><code><xmp>// app/scripts/app.js
angular.module('app', ['lelylan.directives.device', ... ])</xmp></code></pre>

      <h2 id="server">OAuth 2.0 Server</h2>

      <p>
      Lelylan uses an OAuth 2.0 server for authentication and authorization.
      <a href="http://people.lelylan.com/oauth/applications">Register</a> a new application
      and take the generated credentials (Client ID and Redirect URI) before moving to the
      next step.
      </p>

      <img src="public/images/application.png"></img>


      <h2>Add the oauth-ng directive</h2>

      <p>
      To get an authorization token you need to use
      <a href="http://andreareginato.github.io/oauth-ng/" target="blank">oauth-ng</a>,
      an AngularJS directive for OAuth 2.0 (already installed as device directive dependency).
      Open your main.html view and insert the oauth directive with the required configurations.
      </p>

      <pre><code><xmp><oauth
  site="http://people.lelylan.com"
  client-id="CLIENT_ID_HERE"
  redirect-uri="REDIRECT_URI_HERE"
  profile-uri="http://api.lelylan.com/me"
  scope="devices">
</oauth></xmp></code></pre>

      <p class="notice">
      Check out the <a href="http://andreareginato.github.io/oauth-ng/" target="blank">oauth-ng</a>
      docs if you want to better understand how it works.
      </p>


      <h2>Get your devices</h2>

      <p>
      To get all your devices you can use the
      <a href="http://lelylan.github.io/lelylan-ng/" target="_blank">AngularJS client</a>
      for Lelylan (already installed as dependency). Open the main controller
      and place the <code>Device#all</code> method.
      </p>

      <pre><code><xmp>angular.module('newProjectApp')
  .controller('MainCtrl', function ($scope, Device) {
    Device.all()
      .success(function(data) { $scope.devices = data })
      .error(function(data)   { $scope.error   = 'Unauthorized request. Login first.' })
  });</xmp></code></pre>

      <p>
      This is what happens. You inject the <code>Device</code> service and call
      the <code>Device.all()</code> method to get all of your devices and save
      them in <code>$scope.devices</code>.
      </p>


      <h2>Show your devices</h2>

      <p>
      Supposing you have created at least one device with Lelylan
      you are ready to show them. Open the <code>main.html</code>
      view and list your devices by using the device directive.
      </p>

      <p class="notice">
      If you have no devices in Leylan, <a href="http://manage.lelylan.com/new">create</a>
      your first one (it takes few seconds).
      </p>

      <pre><code><xmp><div ng-repeat="device in devices">
  <device device-json="device"></device>
<div></xmp></code></pre>

      <p>
      This is what happens. You iterate between all devices and show them using the device
      directive. To let the directive know which device it has to render you use the attribute
      <code>device-json</code> that accepts any valid device representation.
      </p>

      <p class="notice">
        See the <a href="#configurations">configurations</a> section to see the
        accepted attributes.
      </p>

      <h2>You're done!</h2>

      <p>
      Open your index page, click to the Login link and authorize your application
      to get a new access token. You are now ready to monitor and control all your
      devices.
      </p>

      <p><img src="public/images/device.png" style="width:auto"></img></p>

    </div>
    </section>



    <section>
    <div class="content">
      <h1 id="configurations">Configurations</h1>

      <p>
      The directive accepts the following attributes.
      </p>

      <table class="table">
        <tbody class="smaller-titles">
          <tr>
            <td class="parameter">
              <span>device-json</span>
              <span class="info">optional</span>
            </td>
            <td>
              Device JSON (learn more about the device <a href="http://dev.lelylan.com/developers#get-a-device">representation</a>).
              <span class="info">(required if device-id is not used)</span>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>device-id</span>
              <span class="info">optional</span>
            </td>
            <td>
              Device ID.
              <span class="info">(required if device-json is not used)</span>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>device-template</span>
              <span class="info">optional</span>
            </td>
            <td>
              Custom template to render.<br>
            </td>
          </tr>
        </tbody>
      </table>

      <p>
      Here a few examples.
      </p>

      <table class="table">
        <tbody class="smaller-titles">
          <tr>
            <td>
              <code><xmp><device device-id="DEVICE_ID"></device></xmp></code>
            </td>
          </tr>
          <tr>
            <td>
              <code><xmp><device device-json="DEVICE_JSON"></device></xmp></code>
            </td>
          </tr>
          <tr>
            <td>
              <code><xmp><device device-template="TEMPLATE_URI"></device></xmp></code>
            </td>
          </tr>
        </tbody>
      </table>

      <p class="notice">
      A good habit is to fetch the devices you need first and then render them usig the
      <code>device-json</code> attribute. This will make the system more efficient than
      using the <code>device-id</code> attribute because it fires an HTTP request per device.
      </p>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="customizations">Customizations</h1>

      <p>
        The oauth directive comes to life with customization in mind. You can easily define
        personalized CSS styles or create brand new templates.
      </p>

      <h1 id="curstomization-css">Custom CSS</h1>

      <p>
      The device directive comes to life with a default template. To improve its visual style
      you need to add the custom CSS.
      </p>

      <table class="table button">
        <tbody>
          <tr>
            <td class="parameter">
              <span class="title">
                Default style
              </span>
            </td>
            <td style="text-align: right;">
              (no extra CSS required)
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <img src="public/images/device.png" style="width:auto"></img>
            </td>
            <td></td>
          </tr>
        </tbody>
       </table>

      <table class="table button">
        <tbody>
          <tr>
            <td class="parameter">
              <span class="title">Black style</span>
            </td>
            <td style="text-align: right;">
              &lt;Download CSS&gt;
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <img src="public/images/device.png" style="width:auto"></img>
            </td>
            <td></td>
          </tr>
        </tbody>
       </table>

      <p>
      All CSS rules applies to the default
      <a href="https://github.com/lelylan/device-directive-ng/blob/master/app/views/templates/default.html">HTML template</a>
      and <a href="https://github.com/lelylan/device-directive-ng/blob/master/app/styles/main.css">CSS rules</a>.
      </p>

      <p>
      It's easy to create your own. Base all of your rules on the <code>ly-*</code> classes
      or checkout existing CSS definitions to better understand how it works.
      </p>

      <p class="notice">
      <a href="mailto:andrea.reginato@gmail.com">Mail</a> or <a href="http://twitter.com/andreareginato">Tweet</a>
      me about new CSS personalizations so that we can add them to the doc.</p>
      </p>


      <h1 id="customization-template">Custom Template</h1>

      <p>
      When the custom template does not satisfy your needs (e.g. you want to show the user email
      when logged in), you can create a new one. To have an idea of what a template looks like,
      see the code below (related to the default template).
      </p>

      <pre><code><xmp><span class="oauth">
  <a href="#" class="logged-out" ng-show="show=='logged-out'" ng-click="login()">{{text}}</a>
  <a href="#" class="logged-in"  ng-show="show=='logged-in'"  ng-click="logout()">Logout {{profile.email}}</a>
  <a href="#" class="denied"     ng-show="show=='denied'"     ng-click="login()">Access denied. Try again.</a>
</span></xmp></code></pre>

      <p>
      To create your new template, define the HTML and make it work using the following internal API.
      </p>

      <table class="table smaller-titles">
        <tbody class="smaller-titles">
          <tr>
            <td class="parameter">
              <span>show</span>
              <span class="info">variable</span>
            </td>
            <td>
              Defines the oauth status. <br>
              Valid values are <code>logged-out</code>, <code>logged-in</code> and <code>denied</code>.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>text</span>
              <span class="info">variable</span>
            </td>
            <td>
              Visible text when the widget is logged out.<br>
              Default to <code>Sign in</code>.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>login()</span>
              <span class="info">method</span>
            </td>
            <td>
              Logs in redirecting the app to the OAuth 2.0 authorization server.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>logout()</span>
              <span class="info">method</span>
            </td>
            <td>
              Logs out deleting the access token.
            </td>
          </tr>
        </tbody>
      </table>

      <p>
      Now, supposing you have defined a new template in <code>views/templates/custom.html</code>,
      you need to let the directive know about its existence. You can do this in two ways.
      </p>

      <ul>
        <li>Setting the template attribute</li>
        <li>Firing the template event</li>
      </ul>

      <h2>1 - Template attribute</h2>

      <p>
      Set the template path (or uri) as value for the template attribute.
      </p>

      <pre><code><xmp><oauth
  template="views/templates/custom.html"
  client-id="<client-id>"
  redirect-uri="<redirect-uri>"
  profile-uri="<profile-uri>"
  scope="<your-scope>">
</oauth></xmp></code></pre>

      <h2>2 - Template event</h2>

      <p>
      Fires the update template event passing the template path (or uri) as param.
      </p>

      <pre><code><xmp>$rootScope.$broadcast('oauth:template:update', 'views/templates/custom.html');</xmp></code></pre>

      <p>
      Use this solution when you need to update the directive at runtime. For all
      other cases, use the template attribute.
      </p>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="events">Events</h1>

      <p>
      The events related to the oauth directive are the following.
      </p>

      <table class="table">
        <tbody>
          <tr>
            <td class="parameter">
              <span>oauth:login(token)</span>
              <span class="info">fired</span>
            </td>
            <td>
              Fired when the user has authorized the third party app.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>oauth:logout</span>
              <span class="info">fired</span>
            </td>
            <td>
              Fired when the user logs out.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>oauth:denied</span>
              <span class="info">fired</span>
            </td>
            <td>
              Fired when the user denies the access to the third party app.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>oauth:expired</span>
              <span class="info">fired</span>
            </td>
            <td>
              Fired when the access token is expired.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>oauth:template:update(uri)</span>
              <span class="info">listening</span>
            </td>
            <td>
              Listening for runtime the template change.<br>
              See examples in the <a href="#customizations">customization</a> section.
            </td>
          </tr>
        </tbody>
      </table>

      <p>
      Here some examples.
      </p>

      <pre><code><xmp>$scope.$on('oauth:login', function(event, token) {
  console.log('Authorized third party app with token', token.access_token);
});

$scope.$on('oauth:logout', function(event) {
  console.log('The user has signed out');
});

$scope.$on('oauth:denied', function(event) {
  console.log('The user did not authorize the third party app');
});

$scope.$on('oauth:expired', function(event) {
  console.log('The access token is expired. Please refresh.');
});</xmp></code></pre>


    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="logged">Logged in or logged out?</h1>

      <p>
      Inject the <code>AccessToken.get()</code> service to understand if the user is logged in or out.
      </p>

      <pre><code><xmp>$scope.logged = !!AccessToken.get();</xmp></code></pre>

      <p>
      The <code>AccessToken.get()</code> method returns <code>null</code> when the user is logged
      out and the access token representation when the user is logged in (see below).
      </p>


<pre><code><xmp>{
  "access_token": "9ce03e06f037180c2dcfa8b278217eb56d747730c69xxx",
  "token_type": "bearer",
  "expires_in": 7200,
  "state": "remember-me"
}</xmp></code></pre>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="profile">Profile resource</h1>

      <p>
      When a user signs in, the profile is accessible through the <code>Profile</code> service.
      </p>

      <pre><code><xmp>$scope.profile = Profile.get();</xmp></code></pre>

      <p>
      This profile is accessible only when the <code>profile-uri</code> attribute is defined and
      it sets the Authorization header with the access token to authenticate the request.
      </p>

      <pre><code><xmp>Authorization:Bearer {token}</xmp></code></pre>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="links">Links</h1>

      <ul>
        <li>
        <a href="https://github.com/andreareginato/oauth-ng/" target="blank">Github Repository</a>
        </li>
        <li>
        <a href="https://twitter.com/andreareginato" target="blank">@andreareginato</a>
        </li>
      </ul>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="thanks">Thanks</h1>

      <p>
      <a href="mailto:andrea.reginato@gmail.com" target="_blank">Mail</a> or
      <a href="http://twitter.com/andreareginato" target="_blank">Tweet</a>
      me for any idea that can improve the project.
      </p>

      <p>
      This project was created and released as open-source thanks to <a href="http://lelylan.com" target="_blank">Lelylan</a>,
      a new platform to monitor and control your devices through a simple, open and robust REST API.
      </p>

      <p>
      If you like what I'm doing offer me a coffe
      <script data-gittip-username="andreareginato"
        data-gittip-widget="button"
        src="//gttp.co/v1.js"></script>
      </p>

    </div>
    </section>

    <!-- strict dependencies -->
    <script src="public/bower_components/angular/angular.js"></script>
    <script src="public/bower_components/angular-animate/angular-animate.js"></script>
    <script src="public/bower_components/angular-touch/angular-touch.js"></script>
    <script src="public/bower_components/base64/base64.js"></script>
    <script src="public/bower_components/ngstorage/ngStorage.js"></script>
    <script src="public/bower_components/oauth-ng/dist/oauth-ng.js"></script>
    <script src="public/bower_components/lelylan-ng/dist/lelylan-ng.js"></script>
    <script src="public/bower_components/moment/moment.js"></script>
    <script src="public/bower_components/angular-moment/angular-moment.js"></script>
    <script src="public/bower_components/underscore/underscore.js"></script>

    <!-- test dependencies -->
    <script src="public/bower_components/jasmine/lib/jasmine-core/jasmine.js"></script>
    <script src="public/bower_components/jquery/dist/jquery.js"></script>
    <script src="public/bower_components/jasmine-jquery/lib/jasmine-jquery.js"></script>

    <!-- mock lib -->
    <script src="public/bower_components/angular-mocks/angular-mocks.js"></script>

    <!-- app test -->
    <script src="public/scripts/vendors/app-test.js"></script>
    <script src="public/scripts/vendors/delayed-responses.js"></script>


    <script src="public/bower_components/device-directive-ng/dist/device-component-ng.js"></script>
  </body>
</html>
