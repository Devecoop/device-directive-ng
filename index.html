<!DOCTYPE html>
<html>
  <head>
    <title>device-ng | AngularJS directive to control your devices, on web and mobile</title>
    <link rel="stylesheet" href="public/styles/style.css">
    <link rel="stylesheet" href="public/icons/css/slate.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Italiana" type='text/css'>
    <link rel="stylesheet" href="bower_components/animate.css/animate.css" />
    <link rel="stylesheet" href="bower_components/fontawesome/css/font-awesome.css" />
    <link rel="stylesheet" href="bower_components/device-directive-ng/dist/device-directive-ng.css">
    <link rel="stylesheet" href="public/views/templates/switch/switch.css" />
    <link rel="stylesheet" href="public/views/templates/black/black.css" />
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
  </head>
  <body ng-app="app">

    <section id="top">
    <div id="menu">
      <a id="toggle" href="#">
        <i class="icon-menu"></i>
      </a>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#configurations">Configurations</a></li>
        <li><a href="#custom-templates">Custom templates</a></li>
        <li><a href="#type-specific-templates">Type specific templates</a></li>
        <li><a href="#create-a-template">Create a template</a></li>
        <li><a href="#create-a-light-switch">Create a light switch</a></li>
        <li><a href="#events">Events</a></li>
        <li><a href="#api">Internal API</a></li>
        <li><a href="#links">Links</a></li>
        <li><a href="#thanks">Thanks</a></li>
      </ul>
    </div>

    <div id="heading">
      <div id="logo">&lt;device&gt;</div>
      <div id="tagline">
      The new HTML5 tag built atop <a href="https://angularjs.org/">AngularJS</a>
      and <a href="http://lelylan.com">Lelylan</a><br>
      that makes it easier and faster to create a complete application<br>
      across desktop, tablet, and mobile for the Connected Home.
      </div>
      <div class="device center">
        <device device-id="1"></device>
      <div>
    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="introduction">Introduction</h1>

      <h2>Control anything</h2>

      <p>
      The device directive gives you a ready to use solution to control any physical device in the real world.
      This is possible thanks to <a href="http://lelylan.com/" target="_blank">Lelylan</a>,
      a simple and open REST API for the Connected Home.
      </p>

      <img src="public/images/intuitive.png" style="border:none"></img>

      <h2>Mobile first</h2>

      <p>
      Works across desktop, tablet and mobile, including iPhones, iPads and Android devices.
      </p>

      <img src="public/images/mobile-first.png" style="border:none"></img>

      <h2>Fully customizable</h2>

      <p>
      The device directive comes to life with customization in mind. It offers you a default template,
      but if it doesn't fit your needs, you can easily create new ones only changing few lines of
      CSS and HTML.
      </p>

      <img src="public/images/customizable.png" style="border:none"></img>

    </div>
    </section>


    <section>
    <div class="content">

      <h1 id="overview">Overview</h1>

      <p>
      Install the device directive using <a href="http://bower.io/" target="_blank">Bower</a>.
      </p>

      <pre><code>$ bower install device-directive-ng --save</code></pre>

      <p>
      Use the <code>&lt;device&gt;</code> directive and set the desired device ID.
      </p>

      <pre><code><xmp><device device-id="DEVICE_ID"></device></xmp></code></pre>

    </div>
    </section>


    <section>
    <div class="content">


      <h1 id="getting-started">Getting Started</h1>
      <p>
      In this section you will learn how to use the device directive to monitor and control
      all the devices you have defined in Lelylan.
      </p>

      <!--<p class="btn-group">-->
      <!--<a href="" class="btn" target="_blank">View Demo</a>-->
      <!--<a href="" class="btn" target="_blank">Download Source</a>-->
      <!--</p>-->


      <h2 id="setup">Setup</h2>

      <p>
      To build our app we'll use <a href="http://yeoman.io" target="blank">Yeoman</a>, a collection of tools
      and frameworks helping developers to quickly build web applications.
      </p>

      <ul>
        <li>
        <strong>yo</strong> - perform ripetitive tasks.
        </li>
        <li>
        <strong>grunt</strong> - build, preview and test your project.
        </li>
        <li>
        <strong>bower</strong> - solve the frontend package management.
        </li>
      </ul>


      <h2>Installation</h2>

      <p>
      With a recent version of Node.js installed, install the <code>yo</code> package.
      In this way you have Yo, Grunt and Bower and can run them directly from the command-line.
      </p>

      <pre><code>$ npm install -g yo</code></pre>

      <p>
      With Yeoman you can install additional generators with npm. For this tutorial you need
      to install the AngularJS generator.
      </p>

      <pre><code>$ npm install -g generator-angular</code></pre>


      <h2>Create your AngularJS app</h2>

      <p>
      To begin, go to the terminal, make a new directory and cd into it.
      </p>

      <pre><code>$ mkdir new-project && cd $_</code></pre>

      <p>
      You can now kick-start your AngularJS app.
      </p>

      <pre><code>$ yo angular</code></pre>

      <p>
      It will also ask you if you would like to include Twitter Bootstrap and other stuff.
      Once you've decided, just hit Enter. It will take a while to complete.
      </p>

      <p>
      To preview what the app looks like run the serve command.
      </p>

      <pre><code>$ grunt serve</code></pre>

      <p>
      The server supports LiveReload, meaning you can fire up a text editor, edit a custom
      element and the browser will reload on save.
      </p>


      <h2>Install the device directive</h2>

      <p>
      Install the device directive using <a href="http://bower.io/">Bower</a>.
      </p>

      <pre><code>$ bower install device-directive-ng --save</code></pre>

      <p>
      Now you have <code>&lt;device&gt;</code> directive and all its dependencies ready to be
      used. Restart the server to automatically add the needed javascript files to your index
      page.
      </p>

      <pre><code>$ grunt serve</code></pre>

      <p>
      The setup is now completed.
      </p>


      <h2>Add the device directive</h2>

      <p>
        Inject the device directive into your AngularJS <code>app.js</code>.
      </p>

      <pre><code><xmp>// app/scripts/app.js
angular.module('app', ['lelylan.directives.device', ... ])</xmp></code></pre>

      <h2 id="server">OAuth 2.0 Server</h2>

      <p>
      Lelylan uses an OAuth 2.0 server for authentication and authorization.
      <a href="http://people.lelylan.com/oauth/applications/new">Register</a> a new application
      setting a name (e.g Lelylan App) and the Redirect URI (e.g. http://localhost:9000).
      </p>

      <img src="public/images/application.png"></img>


      <h2>Add the oauth-ng directive</h2>

      <p>
      To get an authorization token you need to use
      <a href="http://andreareginato.github.io/oauth-ng/" target="blank">oauth-ng</a>,
      an AngularJS directive for OAuth 2.0 (already installed as dependency).
      Open your index page and configure the oauth directive by setting the
      <code>client-id</code> and <code>redirect-uri</code> previously defined.
      </p>

      <pre><code><xmp>// app/index.html
<oauth
  site="http://people.lelylan.com"
  client-id="CLIENT_ID"
  redirect-uri="REDIRECT_URI"
  profile-uri="http://api.lelylan.com/me"
  scope="devices">
</oauth></xmp></code></pre>

      <p>
      The oauth directive works just straight when the HTML5 mode is active.
      Inject the <code>$locationProvider</code> into a new AngularJS config
      block and set the HTML5 mode.
      </p>

      <pre><code><xmp>// app/scripts/app.js
.config(function ($locationProvider) {
  $locationProvider.html5Mode(true).hashPrefix('!');
});</xmp></code></pre>

      <p class="notice">
      The oauth directive works also
      <a href="http://andreareginato.github.io/oauth-ng/#html5"> without</a> HTML5 mode.
      Check out the <a href="http://andreareginato.github.io/oauth-ng/" target="blank">oauth-ng</a>
      docs to better understand how OAuth 2.0 works with AngularJS.
      </p>


      <h2>Create your first device</h2>

      <p>
      If you never used Lelylan before you need to create your first device using
      <a href="http://lelylan.github.io/devices-dashboard-ng/#/create" target="_blank">Lelylan Dashboard</a>.
      The fastest way to get started is to simulate a device as showed below. In this way
      you don't need any hardware (perfect for app development).
      </p>

      <img src="public/images/create-device/1.png" class="bordered"></img>
      <img src="public/images/create-device/2.png" class="bordered"></img>
      <img src="public/images/create-device/3.png" class="bordered"></img>


      <h2>Get your devices</h2>

      <p>
      To get all your devices you can use the
      <a href="http://lelylan.github.io/lelylan-ng/" target="_blank">Lelylan client</a>
      for AngularJS (already installed as dependency). Open the controller <code>main.js</code>,
      inject the <code>Device</code> service and place the <code>Device#all</code> method.
      </p>

      <pre><code><xmp>// app/scripts/controllers/main.js
angular.module('newProjectApp')
  .controller('MainCtrl', function ($scope, Device) {
    Device.all()
      .success(function(data) { $scope.devices = data })
      .error(function(data) { $scope.error = 'Unauthorized. Login first.' })
  });</xmp></code></pre>

      <p>
      This is what happens. You inject the <code>Device</code> service and call
      the <code>Device.all()</code> method to get all of your devices and save
      them in <code>$scope.devices</code>.
      </p>


      <h2>Show your devices</h2>

      <p>
      Supposing you have created at least one device with Lelylan
      you are ready to show them. Open the <code>main.html</code>
      view and list your devices by using the device directive.
      </p>

      <iframe src="public/extracts/getting-started.html" scrolling="no" style="margin: 0;border: none;width: 100%;height: 215px;">
      </iframe>

      <p>
      This is what happens. You iterate between all devices and show them using the device
      directive. To let the directive know which device it has to render you use the attribute
      <code>device-json</code> that accepts any valid device representation.
      </p>

      <p class="notice">
        See the <a href="#configurations">configurations</a> section to see the
        accepted attributes.
      </p>

      <h2>You're done!</h2>

      <p>
      Open your index page, click to the Login link and authorize your application
      to get a new access token. You are now ready to monitor and control all your
      devices.
      </p>

      <div class="device"><device device-id="1"></device></div>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="configurations">Configurations</h1>

      <p>
      The directive accepts the following attributes.
      </p>

      <table class="table">
        <tbody class="smaller-titles">
          <tr>
            <td class="parameter">
              <span>device-json</span>
              <span class="info">optional</span>
            </td>
            <td>
              Device JSON.
              <span class="info">(required if device-id is not used)</span>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>device-id</span>
              <span class="info">optional</span>
            </td>
            <td>
              Device ID.
              <span class="info">(required if device-json is not used)</span>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>device-template</span>
              <span class="info">optional</span>
            </td>
            <td>
              Custom template to render.
              Learn more <a href="#custom-templates">about</a>.
            </td>
          </tr>
        </tbody>
      </table>

      <h2>Examples</h2>

<pre><code><xmp>// Load the device by setting its id
<device device-id="DEVICE_ID"></device>

// Load the device by setting its json structure and a specific template
<device device-json="DEVICE_JSON" device-template="TEMPLATE_URI"></device></xmp></code></pre>

      <h2>Tips</h2>

      <p class="notice">
      As good habit, fetch the all your devices first and then render them usig the
      <code>device-json</code> attribute. This will make the system more efficient than
      using the <code>device-id</code> attribute which fires an HTTP request per device.
      </p>

    </div>
    </section>


    <section>
    <div class="content">

      <h1 id="custom-templates">Custom Templates</h1>

      <p>
      The device directive comes to life to be easily customizable. If the default template
      does not satisty your needs, you can create new ones (e.g light specific). All you need
      to do is to personalize the HTML and CSS code.
      </p>

      <p class="notice">
      All examples below are created with <a href="http://codepen.io">Codepen</a>.
      This makes it easy for you to create new templates by forking and editing
      the existing code.
      </p>


      <h2>Configuration</h2>

      <p>
      To set a new template you need to tell to the device directive where the HTML file is
      located.
      </p>

      <h3>1. Template attribute</h3>

      <p>
      Set the template path (or uri) to the <code>device-template</code> attribute.
      </p>

      <pre><code><xmp><device device-template="TEMPLATE_PATH" ... ></device></xmp></code></pre>

      <h3>2. Template event</h3>

      <p>
      Fires the update template event passing an object with the template uri and the
      optional device id (when not set all devices are affected by the change).
      </p>

      <pre><code><xmp>$rootScope.$broadcast(
  'lelylan:directives:device:template',
  { template: 'TEMPLATE_PATH', id: 'DEVICE_ID'}
);</xmp></code></pre>



      <h1>Included templates</h1>

      <h3>
        Default |
        <a href="https://github.com/lelylan/device-directive-ng/blob/master/dist/views/templates/default.html">
          <i class="fa fa-external-link"></i> HTML
        </a> |
        <a href="https://github.com/lelylan/device-directive-ng/blob/master/dist/device-directive-ng.css">
          <i class="fa fa-external-link"></i> CSS
        </a>
      </h3>

      <pre class="indent"><code><xmp><device device-id="DEVICE_ID"></device></xmp></code></pre>


      <div class="device">
      <p data-height="440" data-theme-id="9307" data-slug-hash="Gxgae" data-default-tab="result" data-user="andreareginato" class='codepen'>See the Pen <a href='http://codepen.io/andreareginato/pen/Gxgae/'>Gxgae</a> by Andrea Reginato (<a href='http://codepen.io/andreareginato'>@andreareginato</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
      <script async src="//codepen.io/assets/embed/ei.js"></script>
      </div>


      <h3>
        Compact |
        <a href="https://github.com/lelylan/device-directive-ng/blob/master/dist/views/templates/compact.html">
          <i class="fa fa-external-link"></i> HTML
        </a> |
        <a href="https://github.com/lelylan/device-directive-ng/blob/master/dist/device-directive-ng.css">
          <i class="fa fa-external-link"></i> CSS
        </a>
      </h3>

      <pre class="indent"><code><xmp><device
  device-id="DEVICE_ID"
  device-template="bower_components/device-directive-ng/dist/views/templates/compact.html">
</device></xmp></code></pre>

      <div class="device">
      <p data-height="131" data-theme-id="9307" data-slug-hash="pGrcD" data-default-tab="result" data-user="andreareginato" class='codepen'>See the Pen <a href='http://codepen.io/andreareginato/pen/pGrcD/'>pGrcD</a> by Andrea Reginato (<a href='http://codepen.io/andreareginato'>@andreareginato</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
      <script async src="//codepen.io/assets/embed/ei.js"></script>
      </div>


      <h1>Community templates</h1>

      <p>
      Follows a list of templates created by the community. To use them, as convention,
      download the HTML template and CSS style into <code>views/templates</code> and use
      them as described in the code examples.
      </p>

      <h3>
        Switch |
        <a href="http://codepen.io/andreareginato/pen/czodF?editors=100">
          <i class="fa fa-external-link"></i> HTML
        </a> |
        <a href="http://codepen.io/andreareginato/pen/czodF?editors=010">
          <i class="fa fa-external-link"></i> CSS
        </a>
      </h3>

      <p>
      <em>Valid for any device type</em>.
      </p>

      <p>
      When you click on the switch we apply the default function of the device in a
      specific status of its life (e.g if a light is on, the default function is turn
      off and viceversa).
      </p>

      <pre class="indent"><code><xmp><link rel="stylesheet" href="views/templates/switch.css">
<device device-id="ID" device-template="views/templates/switch.html"></device></xmp></code></pre>

      <div class="device">
      <p data-height="150" data-theme-id="9307" data-slug-hash="czodF" data-default-tab="result" data-user="andreareginato" class='codepen'>See the Pen <a href='http://codepen.io/andreareginato/pen/czodF/'>czodF</a> by Andrea Reginato (<a href='http://codepen.io/andreareginato'>@andreareginato</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
      <script async src="//codepen.io/assets/embed/ei.js"></script>
      </div>


      <br>

      <p class="notice">
        <a href="mailto:dev@lelylan.com">Mail</a>,
        <a href="http://twitter.com/lelylan">Tweet</a> or send us a
        <a href="https://github.com/lelylan/device-directive-ng/tree/gh-pages">pull request</a>
        for any new template. We'll be happy to add them to the project.</p>
      </p>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="type-specific-templates">Type specific templates</h1>

      <p>
      With the device directive we want to define the best user experience when controlling
      the physical world. To make this possible we need to create type specific templates for
      lights, thermostats, locks and more like the ones below.
      </p>

      <img src="public/images/templates/examples/light.png" class="bordered"></img>
      <img src="public/images/templates/examples/thermostat.png" class="bordered"></img>

      <p>
      To reach these results we need to create custom templates for every specific type.
      To easily get started we created the following pens for the most important types.
      </p>

      <br>
      <p>
      <a class="btn" href="http://codepen.io/andreareginato/pen/GmjDI" target="_blank">Switch</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/nKBHF" target="_blank">Light</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/Hhqwv" target="_blank">Lock</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/Lnxjy" target="_blank">Thermostat</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/DniuG" target="_blank">IP Camera</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/pytwj" target="_blank">Alarm System</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/hluvo" target="_blank">Roller Shutter</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/jefAk" target="_blank">Alarm Clock</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/aBtIh" target="_blank">Sprinkler System</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/nwovj" target="_blank">Kettle</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/IoAni" target="_blank">Temperature Sensor</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/rldcE" target="_blank">Fire Sensor</a>
      <a class="btn" href="http://codepen.io/andreareginato/pen/wetuA" target="_blank">City pollution</a>
      </p>
      <br>

      <p class="notice">
      If you want to experiment on a type not listed here
      <a href="mailto:dev@lelylan.com" target="_blank">mail</a> or
      <a href="http://twitter.com/lelylan" target="_blank">tweet</a> us.
      </p>

      <p class="notice">
      To deeply understand how templates can be created, read the next sections.
      </p>

    </section>


    <section>
    <div class="content">

      <h1 id="create-a-template">Create your first (basic) template</h1>

      <p>
      When the existing templates does not satisfy your needs, you can create a new one.
      In this section we'll explain how to create the template below step by step.
      </p>

      <div class="device">
      <device device-id="1" device-template="public/views/templates/custom/custom.html"></device>
      </div>

      <p>
      The code that makes it possible is this.
      </p>

      <script src="https://gist.github.com/andreareginato/61766ae2cc904aa238b9.js"></script>

      <p>
      Let's study step by step what this code does.
      </p>

      <h2>Default function</h2>

      <pre><code><xmp><div class="ly-execute" ng-click="execute(status.function)">
  ...
</div></xmp></code></pre>

      <p>
      As convention, the blue circle is used to execute the device default function (the
      expected functionality you want to execute when a device is in a specific state).
      For example when a light is "turned on" the default function is "turn off" and
      viceversa.
      </p>

      <p>
      To execute the defualt function use <code>execute(status.function)</code>. As you can get
      from the naming it will execute the default function based on the current device status.
      </p>

      <p class="notice">
      The defualt function is kind of a complex topic. You only need to get the general concept,
      but if you want to dig in deep on how it works, check out the
      <a href="http://dev.lelylan.com/types#statuses-api">Status API</a>.
      </p>


      <h2>Lelylan circle</h2>

      <p>
      The blue circle is rendered by the device directive on every element with
      <code>ly-button</code> class.
      </p>

      <pre><code><xmp><button class="ly-button"></button></xmp></code></pre>

      <p>
      In this example we also set a loader identified by the
      <code>ly-spinner</code> class visible only when the device is in a pending status,
      meaning that the request is sent to the physical device and you are waiting for its
      execution to be completed.
      </p>

      <pre><code><xmp><div class="ly-spinner ly-animation" ng-if="device.pending">
  <div class="ly-bounce-1"></div>
  <div class="ly-bounce-2"></div>
  <div class="ly-bounce-3"></div>
</div></xmp></code></pre>

      <h2>Device info</h2>

      <p>
      The last part lets you see the device name (e.g front door lock, kitchen thermostat, etc.)
      and status, which will give you a descriptive overview of the device status in a specific
      moment of its life (e.g. <code>on</code> and <code>off</code> for a basic light,
      <code>open</code> and <code>close</code> for a lock, etc.).
      </p>

      <pre><code><xmp><div class="ly-description">
  <p class="ly-name" ng-bind="device.name"></p>
  <p class="ly-extras ly-updated-animation" ng-bind="status.name"></p>
</div></xmp></code></pre>

      <h2>You are done</h2>

      <p>
      Save the new template under your project and set the path using the template attribute
      and you are done. Congrats. You have created your first custom template
      </p>

      <pre><code><xmp><device device-json="DEVICE_JSON" device-template="TEMPLATE_PATH"></device></xmp></code></pre>

    </div>
    </section>


    <section>
    <div class="content">

      <h1 id="create-a-light-switch">Create your first type specific template</h1>

      <p>
      The device directive defines a user interface that adapts to any device.
      This means that you can control lights, locks, thermostats or any other device without
      any effort.
      While this flexibility is perfect for general purpose solutions, it becomes a weakness
      when you want to monitor and control a specific device. Take a light for example. In the
      real world we control it using a switch. Why should we change this convention?
      </p>

      <h2>Light switch</h2>

      <p>
      That said, we now want to build a template that can be used to control
      a basic light having only the <code>turn on</code> and <code>turn off</code>
      functionalities.
      </p>

      <div class="device" style="width:8.8em;">
        <device device-id="1" device-template="public/views/templates/switch/switch.html"></device>
      </div>

      <h2>Switch Template</h2>

      <p>
      The template is pretty simple. You have a checkbox label that when clicked executes the
      default function. This means that when the light is on the switch turns it off and when
      the light is off the switch turns it on.
      </p>

      <script src="https://gist.github.com/andreareginato/00a120b314523b690e2c.js"></script>

      <p>
      You also have the spinner which is visible only when the device is pending, meaning that
      the request is sent to the physical device and you are waiting for its execution to be
      completed.
      </p>

      <h2>Switch CSS</h2>

      <p>
      This is the CSS you need to get the final switch.
      </p>

      <script src="https://gist.github.com/andreareginato/168ddfb68dbde6f4a6ea.js"></script>

      <p class="notice">
      Many thanks to <a href="http://codepen.io/billycrist/pen/CHmiE">Billy Crist</a>
      for his work.
      </p>

      <h2>Assigning the new template</h2>

      <p>
      Save the new HTML and CSS template files under your project. Now you need to set this
      template only for your lights (not other devices like locks or thermostats).
      To get all devices of a specific type (in this case all lights) you have two solutions.
      </p>

      <pre><code><xmp>// Using Device API passing the Type ID in the query string
Device.all({ type: TYPE_ID }).success(function(devices) {
  scope.devices = devices;
})

// Using JSON filtering (this example uses underscore)
Device.all().success(function(devices) {
  scope.devices = _.where(devices, { type.id: TYPE_ID }
});
</xmp></code></pre>

      <p>
      Now use the template event to set the new template to all previously filtered devices.
      </p>

      <pre><code><xmp>
_.each(scope.devices, function(device) {
  $rootScope.$broadcast(
    'lelylan:device:template:update',
    { template: 'TEMPLATE_PATH', id: device.id}
  );
});</xmp></code></pre>


    </div>
    </section>



    <section>
    <div class="content">

      <h1 id="events" style="clear:both">Events</h1>

      <h2>[Listen] Device loaded</h2>

      <p>
        <code>lelylan:device:load(device)</code><br>
      </p>

      <p>
      Listen for an event fired when the directive has completed the requests to the API.<br>
      As param it receives the loaded device JSON representation.
      </p>

      <pre><code><xmp>$scope.$on('lelylan:device:load', function(event, device) { ... })</xmp></code></pre>


      <h2>[Listen] Device update</h2>

      <p>
        <code>lelylan:device:update:get(device)</code><br>
      </p>

      <p>
      Listen for a device name or phyiscal uri update event.<br>
      As param it receives the updated device JSON representation.
      </p>

      <pre><code><xmp>$scope.$on('lelylan:device:update:get', function(event, device) { ... })</xmp></code></pre>


      <h2>[Fire] Device update</h2>

      <p>
        <code>lelylan:device:update:set(device)</code><br>
      </p>

      <p>
      Fires an event to update a device representation.<br>
      As param you need to send a valid device JSON representation.
      </p>

      <pre><code><xmp>$rootScope.$broadcast('lelylan:device:update:set', device);</xmp></code></pre>


      <h2>[Listen] Properties update</h2>

      <p>
        <code>lelylan:device:properties:get(properties)</code><br>
      </p>

      <p>
      Listen for an event fired when a function starts and some properties are sent to be updated.<br>
      As param it receives the properties to update.
      </p>

      <pre><code><xmp>$scope.$on('lelylan:device:load', function(event, device) { ... })</xmp></code></pre>


      <h2>[Listen] Device delete</h2>

      <p>
        <code>lelylan:device:deleted(device)</code><br>
      </p>

      <p>
      Listen for device deletion.<br>
      As param it sends the deleted JSON device representation.
      </p>

      <pre><code><xmp>$scope.$on('lelylan:device:delete', function(event, device) { ... });</xmp></code></pre>


      <h2>[Fire] Update device(s) template</h2>

      <p>
        <code>lelylan:device:template({template: "TEMPLATE_PATH", id: "DEVICE_ID"})</code><br>
      </p>

      <p>
        Fires the update of the directive template. The event accepts an object with the following options.
      </p>

      <table class="table smaller-titles">
        <tbody class="smaller-titles">
          <tr>
            <td class="parameter">
              <span>template</span>
              <span class="info">required</span>
            </td>
            <td>
              Template path (or uri) value.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>id</span>
              <span class="info">optional</span>
            </td>
            <td>
              Device ID indicating the device targeted to update the template.</br>
              (when missing all devices are targeted to update the template).
            </td>
          </tr>
        </tbody>
      </table>

      <pre><code><xmp>$rootScope.$broadcast(
  'lelylan:directives:device:template',
  { template: 'TEMPLATE_PATH', id: 'DEVICE_ID'}
);</xmp></code></pre>


      <h2>[Listen] Custom events</h2>

      <p>
        <code>lelylan:device:custom:EVENT_NAME(device)</code><br>
      </p>

      <p>
      Listen for a custom event (as param it sends the JSON device representation).
      This is a special event tha can be used when defining a new template and interacting
      with specific parts of it.
      </p>

      <pre><code><xmp>$scope.$on('lelylan:device:custom:EVENT_NAME', function(event, device) { ... });</xmp></code></pre>


      <h3>Example</h3>

      <p>
      An example is the custom event <code>lelylan:device:custom:open(device)</code>
      that is fired in the compact template when you click the right arrow.
      </p>

      <br>
      <div ng-controller="CustomEventController">
        <p class="notice">
        <span ng-bind="text"></span>
        <span ng-if="message!=text"><a href="#" ng-click="reset()">[reset]</a></span>
        </p>
      </div>

      <div class="device compact">
        <device device-id="1" device-template="bower_components/device-directive-ng/dist/views/templates/compact.html"></device>
      </div>
      <br>

      <script>
        function CustomEventController($scope, $timeout) {
          $scope.message = 'Click the blue arrow to fire the custom event.';
          $scope.text = $scope.message;

          $scope.$on('lelylan:device:custom:open', function(event, device) {
            $scope.text = 'The custom:open event was fired from the ' + device.name;
          });
          $scope.reset = function() {
            $scope.text = $scope.message;
          }
        }
      </script>

      <p>
      To make this possible we attach the <code>fire('open')</code> function to the
      right arrow click event. In this way the directive will automatically fire the
      open custom event that we can easily catch with the following code.
      </p>

      <pre><code><xmp>$scope.$on('lelylan:device:custom:open', function(event, device) {
  $scope.text = 'The custom:open event was fired from the ' + device.name;
});</xmp></code></pre>


    </div>
    </section>


    <section>
    <div class="content">

      <h1 id="api">Internal API (Advanced)</h1>

      <p>
      Any template is composed by mix of HTML (structure), CSS (visual) and AngularJS (logic).
      In the previous section you saw the template using some JavaScript functions (e.g.
      <code>execute(status.function)</code>) or varialbles (e.g <code>device.pending</code>).
      To give you full control during the template definition we now describe the internal
      API offered by the directive.
      </p>

      <table class="table smaller-titles">
        <tbody class="smaller-titles">
          <tr>
            <td class="parameter">
              <span>device</span>
              <span class="info">variable</span>
            </td>
            <td>
              JSON object representing a <a href="http://dev.lelylan.com/developers#get-a-device">device</a>.
              Keys used quite often are.
              <ul>
                <li><code>device.id</code> - device identifier</li>
                <li><code>device.name</code> - device name</li>
                <li><code>device.pending</code> - true when requests are being resolved</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>type</span>
              <span class="info">variable</span>
            </td>
            <td>
              JSON object representing a device <a href="http://dev.lelylan.com/types#get-a-type">type</a>.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>privates</span>
              <span class="info">variable</span>
            </td>
            <td>
              JSON object representing a device
              <a href="http://dev.lelylan.com/developers#get-a-device-private-info">private info</a>.
              Keep in mind that <code>privates</code> are loaded only when
              <code>showSettings()</code> is called and the logged user is the creator.
              </p>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>functions</span>
              <span class="info">variable</span>
            </td>
            <td>
              JSON object representing the device <a href="http://dev.lelylan.com/types#get-a-function">functions</a>.
              Each of them can be executed using the <code>execute()</code> method.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>status</span>
              <span class="info">variable</span>
            </td>
            <td>
              JSON object representing the current device <a href="http://dev.lelylan.com/types#get-a-type">status</a>.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>view.path</span>
              <span class="info">variable</span>
            </td>
            <td>
              String representing the active view. Above you can see the keys used by
              the default template to switch between different views.
              <ul>
                <li><code>/loading</code> - directive is loading (resolving the API requests) </li>
                <li><code>/default</code> - default view (control and monitoring)</li>
                <li><code>/settings</code> - settings view (device info)</li>
                <li><code>/message</code> - generic message</li>
                <li><code>/delete</code> - directive deleted message</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>execute(function)</span>
              <span class="info">function</span>
            </td>
            <td>
              This function executes a function.
              When params are required from the user the <code>function.visibleForm</code>
              variable is set to true. This let you show the form that needs to be filled
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>update()</span>
              <span class="info">function</span>
            </td>
            <td>
              Update the device name or the device physical URI.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>destroy(name)</span>
              <span class="info">function</span>
            </td>
            <td>
              Delete the device passing the device name as security check.
              <p class="notice">
              This function is available only for the device maker. If you did not
              create the device, you will not be able to delete the device.
              </p>
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>isMaker()</span>
              <span class="info">function</span>
            </td>
            <td>
              Returns true if the logged user is the creator of the device.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>fire(EVENT_NAME)</span>
              <span class="info">function</span>
            </td>
            <td>
              Fires an event where the prefix is <code>lelylan:device:custom:</code>
              and the suffix is the <code>EVENT_NAME</code>. Supposing the event name is
              <code>open</code>, the custom event will be <code>lelylan:device:custom:open</code>.
            </td>
          </tr>
          <tr>
            <td class="parameter">
              <span>showSettings()</span>
              <span class="info">function</span>
            </td>
            <td>
              Sets the path to <code>/settings</code> and load the device <code>privates</code>
              info (if the logged user is the creator).
            </td>
          </tr>
        </tbody>
      </table>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="links">Links</h1>

      <ul>
        <li>
        <a href="https://github.com/lelylan/device-directive-ng" target="blank">
          Github Repository
        </a>
        </li>
        <li>
        <a href="http://andreareginato.github.io/oauth-ng" target="blank">
          OAuth 2.0 Directive for AngularJS
        </a>
        </li>
        <li>
        <a href="http://lelylan.github.io/lelylan-ng" target="blank">
          Lelylan Client for AngularJS
        </a>
        </li>
        <li>
        <a href="http://dev.lelylan.com" target="blank">
          Lelylan Dev Center
        </a>
        </li>
      </ul>

    </div>
    </section>


    <section>
    <div class="content">
      <h1 id="thanks">Thanks</h1>

      <p>
      <a href="mailto:dev@lelylan.com" target="_blank">Mail</a> or
      <a href="http://twitter.com/lelylan" target="_blank">Tweet</a>
      us for any idea that can improve the project.
      </p>

    </div>
    </section>

    <!-- test dependencies -->
    <script src="bower_components/jasmine/lib/jasmine-core/jasmine.js"></script>
    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/jasmine-jquery/lib/jasmine-jquery.js"></script>

    <!-- strict dependencies -->
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/angular-route/angular-route.js"></script>
    <script src="bower_components/angular-animate/angular-animate.js"></script>
    <script src="bower_components/angular-touch/angular-touch.js"></script>
    <script src="bower_components/base64/base64.js"></script>
    <script src="bower_components/ngstorage/ngStorage.js"></script>
    <script src="bower_components/oauth-ng/dist/oauth-ng.js"></script>
    <script src="bower_components/lelylan-ng/dist/lelylan-ng.js"></script>
    <script src="bower_components/moment/moment.js"></script>
    <script src="bower_components/angular-moment/angular-moment.js"></script>
    <script src="bower_components/underscore/underscore.js"></script>

    <!-- device directive -->
    <script src="bower_components/device-directive-ng/dist/device-directive-ng.js"></script>

    <!-- mock lib -->
    <script src="bower_components/angular-mocks/angular-mocks.js"></script>

    <!-- app test -->
    <script src="public/scripts/vendors/app-test.js"></script>
    <script src="public/scripts/vendors/delayed-responses.js"></script>

    <script>
      $('a').each(function() {
        var a = new RegExp('/' + window.location.host + '/');
        if(!a.test(this.href)) {
          $(this).click(function(event) {
            event.preventDefault();
            event.stopPropagation();
            window.open(this.href, '_blank');
          });
        }
      });
    </script>
  </body>
</html>
